<div class="modal-backdrop">
  <div class="modal-content">
    <button class="close-btn" (click)="closeForm()">✖</button>
    <h2 class="modal-title">Create New User</h2>

    <!-- Success Popup -->
    <div class="success-popup" *ngIf="showSuccess">
      <span>User saved successfully</span>
      <button class="close-success" (click)="showSuccess = false">✖</button>
    </div>

    <!-- Profile Picture Section -->
    <div class="profile-picture-section">
      <div class="profile-image-wrapper">
        <img
          [src]="ProfileImage || defaultImage"
          width="130"
          height="130"
          alt="Profile Image"
        />

        <!-- Camera icon overlay -->
        <div class="camera-overlay" (click)="toggleOptions = !toggleOptions">
          <i class="fa fa-camera"></i>
        </div>

        <!-- Options popup -->
        <div class="image-options" *ngIf="toggleOptions">
          <div (click)="fileInput.click()">Choose from Gallery</div>
          <div (click)="openCamera()">Take Photo</div>
          <div (click)="removeImage()" [class.disabled]="!ProfileImage">
            Remove Photo
          </div>
        </div>
      </div>

      <!-- Hidden file input -->
      <input
        type="file"
        (change)="onFileSelected($event)"
        #fileInput
        style="display: none"
      />
    </div>

    <!-- User Form -->
    <form [formGroup]="userForm" (ngSubmit)="onSave()">
      <div class="form-row">
        <div class="form-group input-container">
          <label>First Name <span class="required">*</span></label>
          <input
            type="text"
            formControlName="Firstname"
            placeholder="Enter First Name"
          />
          <span
            class="clear-icon"
            *ngIf="userForm.get('Firstname')?.value"
            (click)="clearField('Firstname')"
            >&#10005;</span
          >
          <div
            class="error-messages"
            *ngIf="
              userForm.get('Firstname')?.touched &&
              userForm.get('Firstname')?.invalid
            "
          >
            <small *ngIf="userForm.get('Firstname')?.errors?.['required']"
              >First Name is required</small
            >
          </div>
        </div>
        <div class="form-group input-container">
          <label>Last Name <span class="required">*</span></label>
          <input
            type="text"
            formControlName="Lastname"
            placeholder="Enter Last Name"
          />
          <span
            class="clear-icon"
            *ngIf="userForm.get('lastname')?.value"
            (click)="clearField('lastname')"
            >&#10005;</span
          >
          <div
            class="error-messages"
            *ngIf="
              userForm.get('Lastname')?.touched &&
              userForm.get('Lastname')?.invalid
            "
          >
            <small *ngIf="userForm.get('Lastname')?.errors?.['required']"
              >Last Name is required</small
            >
          </div>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group input-container">
          <label>Email <span class="required">*</span></label>
          <input
            type="email"
            formControlName="UserEmail"
            placeholder="Enter Email"
          />
          <div
            class="error-messages"
            *ngIf="
              userForm.get('UserEmail')?.touched && userForm.get('UserEmail')?.invalid
            "
          >
            <small *ngIf="userForm.get('UserEmail')?.errors?.['required']"
              >Email is required</small
            >
            <small *ngIf="userForm.get('UserEmail')?.errors?.['UserEmail']"
              >Enter a valid email address</small
            >
          </div>
        </div>
        <div class="form-group input-container">
          <label>Employee ID</label>
          <input
            type="text"
            formControlName="EmployeeId"
            placeholder="Enter Employee ID"
          />
          <span
            class="clear-icon"
            *ngIf="userForm.get('EmployeeId')?.value"
            (click)="clearField('EmployeeId')"
            >&#10005;</span
          >
        </div>
      </div>

      <div class="form-row">
        <div class="form-group input-container">
          <label>Phone Number</label>
          <input
            type="text"
            formControlName="PhoneNumber"
            placeholder="Enter Phone Number"
          />
          <span
            class="clear-icon"
            *ngIf="userForm.get('PhoneNumber')?.value"
            (click)="clearField('PhoneNumber')"
            >&#10005;</span
          >
          <div
            class="error-messages"
            *ngIf="
              userForm.get('PhoneNumber')?.touched &&
              userForm.get('PhoneNumber')?.invalid
            "
          >
            <small *ngIf="userForm.get('PhoneNumber')?.errors?.['required']"
              >Phone Number is required</small
            >
            <small *ngIf="userForm.get('PhoneNumber')?.errors?.['pattern']"
              >Enter a valid 10-digit number</small
            >
          </div>
        </div>
        <div class="form-group input-container">
          <label>Mobile Number <span class="required">*</span></label>
          <input
            type="text"
            formControlName="MobileNumber"
            placeholder="Enter Mobile Number"
          />
          <span
            class="clear-icon"
            *ngIf="userForm.get('MobileNumber')?.value"
            (click)="clearField('MobileNumber')"
            >&#10005;</span
          >
          <div
            class="error-messages"
            *ngIf="
              userForm.get('MobileNumber')?.touched &&
              userForm.get('MobileNumber')?.invalid
            "
          >
            <small *ngIf="userForm.get('MobileNumber')?.errors?.['required']"
              >Mobile Number is required</small
            >
            <small *ngIf="userForm.get('MobileNumber')?.errors?.['pattern']"
              >Enter a valid 10-digit number</small
            >
          </div>
        </div>
      </div>

      <!-- Checkboxes -->
      <div class="checkbox-row1">
        <label>
          <input type="checkbox" formControlName="isActive" />
          Is Active?
        </label>
      </div>

      <!-- Radio Buttons -->
      <div class="radio-row">
        <label class="radio-label">Is Admin?</label>
        <label>
          <input type="radio" formControlName="IsAdmin" [value]="true" />
          Yes
        </label>
        <label>
          <input type="radio" formControlName="IsAdmin" [value]="false" />
          No
        </label>
      </div>

      <!-- Submit Button -->
      <button type="submit">Save</button>
    </form>
  </div>
</div>
